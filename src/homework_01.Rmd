---
title: "SMDS - EXERCISES"
output:
  html_document: default
  pdf_document: default
---

# DAAG Esercises

## Exercise 1

(a)  Plot sale.price versus area.
(b)  Use the hist() command to plot a histogram of the sale prices. 
(c)  Repeat (a) and (b) after taking logarithms of sale prices.
(d)  The two histograms emphasize different parts of the range of sale prices. Describe the differences.

```{r}
area_set <- c(694, 905, 802, 1366, 716, 963, 821, 714, 1018, 887)
price_set <- c(192.0, 215.0, 215.0, 274.0, 112.7, 185.0, 212.0, 220.0, 276.0, 260.0)

data <- data.frame(area = area_set, sale.price = price_set, stringsAsFactors = FALSE)


par(mfcol = c(2, 2))

plot(data$sale.price, data$area, main="Data Rappresentation", xlab="sale", ylab = "area")
hist(data$sale.price, main = "Sales Histogram", col = palette(), xlab = "sale")

log_price_set <- log(price_set)

data_log <- data.frame(area = area_set, sale.price = log_price_set, stringsAsFactors = FALSE)

plot(data_log$sale.price, data_log$area, main="Data Rappresentation", xlab="log sale", ylab = "area")
hist(data_log$sale.price, main = "Sales Histogram", col = palette(), xlab = "log sale")
```



## Exercise 17

Given a vectorx, the following demonstrates alternative ways to create a vector of numbers from 1 through n, where n is the length of the vector:
x <-  c(8, 54, 534, 1630, 6611)
seq(1, length(x))seq(along=x)
Now set x <- NULLand repeat each of the calculations seq(1, length(x)) and seq(along=x). Which version of the calculation should be used in order to return a vectorof length 0 in the event that the supplied argument is NULL.


```{r}
x <- c(8, 54, 534, 1630, 6611)
seq(1, length(x))
seq(along = x)

x <- NULL
length(seq(1, length(x)))
length(seq(along = x)) # it's length is zero, return this one
```


# C.S. Exercises

## Exercise 1.6

Let $X$ and $Y$ be non-independent random variables, such that $var(X) =σ_{X}^{2}$, $var(Y)=σ_{Y}^{2}$ and $cov(X, Y) =σ_{X, Y}^{2}$. 
Using the result from Section 1.6.2, find $var(X+Y)$ and $var(X−Y)$.

If we define $Z = X + Y$, than we can compute $Var(Z)$ as follow:

$Var(Z) = E[(Z - E[Z])^{2}] = E[(X + Y - E[X + Y])^{2}] = E[((X - E[X]) + (Y - E[Y]))^{2}] =$ 

$E[(X - E[X])^{2}] + E[(Y - E[Y])^{2}] + 2 \cdot E[(X - E[X]) \cdot (Y - E[Y])] = \sigma_{X}^{2} + \sigma_{Y}^{2} + 2 \cdot \sigma_{X, Y}^{2}$

If we define $Z = X - Y$, than we can compute $Var(z)$ as follow:

$Var(Z) = E[(Z - E[Z])^{2}] = E[(X - Y - E[X - Y])^{2}] = E[((X - E[X]) - (Y - E[Y]))^{2}] =$ 

$E[(X - E[X])^{2}] + E[(Y - E[Y])^{2}] - 2 \cdot E[(X - E[X]) \cdot (Y - E[Y])] = \sigma_{X}^{2} + \sigma_{Y}^{2} - 2 \cdot \sigma_{X, Y}^{2}$

## Exercise 1.8

If $log(X)∼N(μ, σ^{2})$, find the p.d.f. of $X$.

From the Transformation Theorem for r.v. we can define the c.d.f.:

$F_{log(X)}(x) = P(log(X) \leq x) = P(X \leq e^{x}) = F_{X}(e^{x}) = \int_{0}^{e^{x}} \frac{1}{\sqrt{2 \cdot \pi \cdot \sigma^{2}}} \cdot e^{- \frac{(t - \mu)^{2}}{2}} \space dt$.

And also the p.d.f.:

$f_{X}(x) = \frac{d F_{X}(e^{x})}{dx} = \frac{1}{\sqrt{2 \cdot \pi \cdot \sigma^{2}}} \cdot e^{- \frac{(e^{x} - \mu)^{2}}{2}}$.

## Exercise 1.9

Discrete random variable $Y$ has a Poisson distribution with parameter $λ$ if its p.d.f. is $f(y) =λ \cdot y \cdot e^{- \frac{\lambda}{y!}}$, for $y= 0,1, \dots$

#### a) Find the moment generating function for $Y$ (hint: the power series repre-sentation of the exponential function is useful).

The momenti generating function (mgf) is defined as:
$G_{Y}(t) = E[e^{t \cdot Y}] = \sum_{i = 1}^{n} p_{i} \cdot e^{t \cdot Y_{i}}$.

In case of discrete distribution, so the mgf for the Poisson distribution is the following one:
$G_{Y}(t) = \sum_{i = 0}^{\infty} e^{t \cdot i} \cdot \lambda^{i} \cdot \frac{e^{-\lambda}}{i!} = e^{-\lambda} \cdot \sum_{i = 0}^{\infty} \frac{(\lambda \cdot e^{t})^{i}}{i!} = e^{-\lambda} \cdot e^{\lambda \cdot e^{t}} = e^{\lambda \cdot (e^{t} - 1)}$

#### b) If $Y_{1}∼Poi(λ_{1})$ and independently $Y_{2}∼Poi(λ_{2})$ deduce the distribution of $Y_{1}+Y_{2}$, by employing a general property of m.g.f.s.

Here we can apply the mgf property with indipendent random variables:
$G_{Y_{1} + Y_{2}}(t) = G_{Y_{1}}(t) \cdot G_{Y_{2}}(t) = e^{\lambda_{1} \cdot (e^{t} - 1)} \cdot e^{\lambda_{2} \cdot (e^{t} - 1)} = e^{(\lambda_{1} + \lambda_{2}) \cdot (e^{t}-1)}$

Note that this is the mfg of a Poinsson distribution with $\lambda = \lambda_{1} + \lambda_{2}$.

#### c) Making use of the previous result and the central limit theorem, deduce the normal approximation to the Poisson distribution.

Note that $X_{n} ~ Poi(n)$ and consider the standardized Poisson $\frac{X_{n}-n}{\sqrt{n}}$, then:

$\lim_{n \rightarrow\infty}  E[e^{t \cdot \frac{X_{n}-n}{\sqrt{n}}}] = \lim_{n \rightarrow\infty} e^{- t\cdot \sqrt{n}} \cdot E[e^{t \cdot \frac{X_{n}}{\sqrt{n}}}] =$

$\lim_{n \rightarrow\infty} e^{- t\cdot \sqrt{n}} \cdot e^{n \cdot (e^{\frac{t}{\sqrt{n}}} - 1)} = \lim_{n \rightarrow\infty} e^{-t \cdot \sqrt{n} + n \cdot (1 + t \cdot n^{\frac{1}{2}} + \frac{t^{2} \cdot n^{-1}}{2} + \cdots -1)} =$

$\lim_{n \rightarrow\infty} e^{-t \cdot \sqrt{n} + t \cdot \sqrt{n} + \frac{t^{2}}{2} + \frac{t^{3}}{6 \cdot \sqrt{n}} + \cdots} = \lim_{n \rightarrow\infty} e^{\frac{t^{2}}{2}} \cdot e^{(\frac{t^{3}}{6 \cdot \sqrt{n}} + \cdots)} = e^{\frac{t^{2}}{2}}$

Where $e^{\frac{t^{2}}{2}}$ is the mgf of the standard normal distribution. 

#### d) Confirm the previous result graphically, using R functions dpois, dnorm, plotorbarplotandlines. Confirm that the approximation improves with increasing $λ$.

```{r}
x <- seq(from = 0, to = 20, by = 1)
lambda <- c(0.7, 1.2, 5, 15)

par(mfcol = c(2, 2))
for(i in 1:4){
  poisson_distribution <- dpois(x, lambda[i])
  normal_distribution <- dnorm(x, mean = lambda[i], sd = sqrt(lambda[i]))
  
  plot(x, poisson_distribution, type = "l", ylab = "F(x)", 
       main = paste("lambda = ", lambda[i]), col = "blue")
  lines(x, normal_distribution, type = "l", col = "red")
  legend("topright", legend = c("poisson", "normal"), 
         col = c("blue", "red"), lty = c(1, 1))
}
```





